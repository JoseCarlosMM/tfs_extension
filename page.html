<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Hello World</title>
        <script src="sdk/VSS.SDK.js"></script>
        <link type="text/css" rel="stylesheet" href="stylesheet.css"/>
    </head>
    <body>
        <script type="text/javascript"> VSS.init({
            explicitNotifyLoaded: true,
            usePlatformScripts: true, 
            usePlatformStyles: true
            });
        </script>
		 <script>
         function addEvent(obj, event, func) {
            if (obj.addEventListener) {
                obj.addEventListener(event, func, false);
                return true;
            } else if (obj.attachEvent) {
                obj.attachEvent('on' + event, func);
            } else {
                var f = obj['on' + event];
                obj['on' + event] = typeof f === 'function' ? function() {
                    f();
                    func();
                } : func
            }
        }
        </script>

		 <div id="Features">
            <h2>Features in progress:</h2>
            <div id="FeaturesGrid">
            <script type="text/javascript"> VSS.require(["out/Features"], function (dashboard) { }); </script>
            </div>
		</div>
        <div id="PBI">
            <h2>Product backlog items</h2>
           <script type="text/javascript">  VSS.require(["out/PBIs"], function (dashboard) { }) ; 
            addEvent(document.getElementById('PBI'), 'click', function() {
               
                var vsoContext = VSS.getWebContext();
                 var extensionContext = VSS.getExtensionContext();

               var baseUrl =  vsoContext.host.uri;
               console.log(baseUrl);
 
                
               window.parent.location.href = vsoContext.host.uri
                + vsoContext.project.name 
                + "/_backlogs";
             });
             </script>
        </div>

        <div id="Burnchart">
            <h2>Burnchart</h2>
            <img src="https://almlatam.visualstudio.com/DefaultCollection/89551369-2a98-4ad4-b36d-738e098395a3/_api/_teamChart/Burndown?chartOptions=%7B%22Width%22%3A887%2C%22Height%22%3A433%2C%22ShowDetails%22%3Atrue%2C%22Title%22%3A%22%22%7D&counter=2&iterationPath=Glimpse+and+Application+Insights\Sprint+91&__v=5" >
        </div>

        <div id="Quality">
            <h2>Quality Stats - Current Sprint</h2>
            <script type="text/javascript"> VSS.require(["out/Quality"], function (dashboard) { }); </script>
        </div>
        
        <div id="Build">
            <h2>Last Build</h2>
        </div>

        <div id="SprintStatus">
            <h2>Sprint Status</h2>
        </div>
    </body>
</html>